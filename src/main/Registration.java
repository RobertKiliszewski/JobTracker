package main;

/*				Imports					*/
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.sql.*;
/*				Imports					*/

public class Registration {
	/*			Variables				*/
	private JFrame registrationFrame;
	private JTextField nameField;
	private JTextField surnameField;
	private JTextField usernameField;
	private JTextField passwordField;
	private JTextField workplaceField;
	/*			Variables				*/

	
	
	/**
	 * Launch the application.
	 */
	public static void main(String[] args) {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					Registration window = new Registration();
					window.registrationFrame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}

	/**
	 * Create the application.
	 */
	public Registration() {
		initialize();
	}

	/**
	 * Initialize the contents of the frame.
	 */
	private void initialize() {
		registrationFrame = new JFrame("Registraion");
		registrationFrame.getContentPane().setForeground(Color.BLACK);
		registrationFrame.getContentPane().setBackground(Color.DARK_GRAY);
		registrationFrame.setBounds(100, 100, 450, 300);
		registrationFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		registrationFrame.getContentPane().setLayout(null);
		registrationFrame.setLocationRelativeTo(null);
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Workplace Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		JLabel lblWorkplace = new JLabel("WorkPlace:");
		lblWorkplace.setForeground(Color.BLACK);
		lblWorkplace.setBounds(74, 29, 96, 14);
		registrationFrame.getContentPane().add(lblWorkplace);
		
		workplaceField = new JTextField();
		workplaceField.setBounds(180, 26, 86, 20);
		registrationFrame.getContentPane().add(workplaceField);
		workplaceField.setColumns(10);
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Workplace Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Name Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		JLabel lblName = new JLabel("Name:");
		lblName.setForeground(Color.BLACK);
		lblName.setBounds(74, 122, 96, 14);
		registrationFrame.getContentPane().add(lblName);
		
		nameField = new JTextField();
		nameField.setBounds(180, 119, 86, 20);
		registrationFrame.getContentPane().add(nameField);
		nameField.setColumns(10);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Name Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Surname Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		JLabel lblSurname = new JLabel("Surname:");
		lblSurname.setForeground(Color.BLACK);
		lblSurname.setBounds(74, 153, 96, 14);
		registrationFrame.getContentPane().add(lblSurname);
		
		surnameField = new JTextField();
		surnameField.setBounds(180, 150, 86, 20);
		registrationFrame.getContentPane().add(surnameField);
		surnameField.setColumns(10);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Surname Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			User name Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		JLabel lblUsername = new JLabel("Username:");
		lblUsername.setForeground(Color.BLACK);
		lblUsername.setBounds(74, 60, 96, 14);
		registrationFrame.getContentPane().add(lblUsername);
		
		usernameField = new JTextField();
		usernameField.setBounds(180, 57, 86, 20);
		registrationFrame.getContentPane().add(usernameField);
		usernameField.setColumns(10);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			User name Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Password Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		JLabel lblPassword = new JLabel("Password:");
		lblPassword.setForeground(Color.BLACK);
		lblPassword.setBounds(74, 91, 96, 14);
		registrationFrame.getContentPane().add(lblPassword);
		
		passwordField = new JTextField();
		passwordField.setBounds(180, 88, 86, 20);
		registrationFrame.getContentPane().add(passwordField);
		passwordField.setColumns(10);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Password Field					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Register BTN					 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		JButton btnRegister = new JButton("Register");
		btnRegister.setBackground(Color.LIGHT_GRAY);
		/*														Action Listener															*/
		btnRegister.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {
				insert();
			}	
		});
		/*														Action Listener															*/
		btnRegister.setBounds(335, 193, 89, 23);
		registrationFrame.getContentPane().add(btnRegister);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Register BTN				 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Cancel BTN				 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		JButton btnCancel = new JButton("Cancel");
		btnCancel.setBackground(Color.LIGHT_GRAY);
		btnCancel.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				registrationFrame.setVisible(false);
			}
		});
		btnCancel.setBounds(335, 227, 89, 23);
		registrationFrame.getContentPane().add(btnCancel);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////			Cancel BTN				 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
	}
	
	
	/*									This Allows the Frame to be visible if called from another frame via a button				*/
	public void setVisible(boolean b) {
		this.registrationFrame.setVisible(b); 
	}
	
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////			Insert Function				 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	public void insert()
	{   
	    try {
	    	if(workplaceField.getText().length()==0){
	    		 // Checking if Workplace is empty
	    		 JOptionPane.showMessageDialog(null, "Empty fields detected ! Please fill up all fields");
	    	}
	    		else if(usernameField.getText().length()==0){
	    		  // Checking if username is empty
			      JOptionPane.showMessageDialog(null, "Empty fields detected ! Please fill up all fields");
	    	  }
			   else if(passwordField.getText().length()==0){
				   // Checking if password is empty
				  JOptionPane.showMessageDialog(null, "Empty fields detected ! Please fill up all fields");
			   }
			   else if(nameField.getText().length()==0){  
				   //  Checking if Name is empty
				  JOptionPane.showMessageDialog(null, "Empty fields detected ! Please fill up all fields");
			   }
			   else if(surnameField.getText().length()==0){  
				   //  Checking if surname is empty
				  JOptionPane.showMessageDialog(null, "Empty fields detected ! Please fill up all fields");
			   }
			   else{
				   String workplace = workplaceField.getText();
				   String username = usernameField.getText();
				   String password = passwordField.getText();
				   String name = nameField.getText();
				   String surname = surnameField.getText();
				   
				  
				   /*		If username exists then username has to be changed in order to create a user 		*/
				   if(userExists(username)){
					   JOptionPane.showMessageDialog(null, "Username Already In use! Please Choose Another Username");
				   }
				   
				   /*									Otherwise create the user							*/
				   else{
				 
					   /*								connection									*/ 
					   Class.forName("com.mysql.jdbc.Driver").newInstance();
					   Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/mydb?user=root&password=");
					   Statement st = con.createStatement();
					   /*								MySQL command 																*/
					   st.executeUpdate("insert into users(work_place, username, password, name, surname) VALUES( '"+workplace+"','"+username+"','"+password+"' ,'"+name+"','"+surname+"')");
					   JOptionPane.showConfirmDialog(null, "User Created!", "User", JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE);
					   st.close();
					   con.close();
					   /*									Close Registration 														*/
					   registrationFrame.setVisible(false);
				   }
			 }
	    	  
	    }//try
	    catch (Exception e1)

	    {
	        System.out.println("Exception:" + e1);
	    }
	  
	}//Insert
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////			Insert Function				 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////			User Exists Function			 	////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	private boolean userExists(String username) {
		   try{           
			   
		       Class.forName("com.mysql.jdbc.Driver");  // MySQL database connection
		       Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/mydb?" + "user=root&password=");   
		       /*								MySQL command 																*/
		       PreparedStatement pst = conn.prepareStatement("Select username from users where username = ?");
		       pst.setString(1, username); 
		       pst.executeQuery();                        
		       ResultSet rs = pst.executeQuery();                        
		       if(rs.next()){            
		           return true;    
		       }
		   }
		   catch(Exception e){
		       e.printStackTrace();
		       return false;
		   }
		return false;
      
		}
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////			User Exists Function				 	 ///////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}//Registration

